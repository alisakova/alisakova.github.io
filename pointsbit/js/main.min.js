
var openLinks = document.querySelectorAll("._open-popup-block");
var popupBlocks = document.querySelectorAll("._popup-block");
var body = document.querySelector("body");

if (openLinks && popupBlocks) {
  openLinks.forEach(function(item) {
    item.addEventListener("click", function(e) {
      e.stopPropagation();
      var parent = e.target.closest("._popup-block-container");
      var popupBlock = parent.querySelector("._popup-block");
      popupBlock.classList.toggle("active");
      popupBlocks.forEach(function(item) {
        if (item.classList.contains("active") && item !== popupBlock) {
          item.classList.remove("active");
        }
      });
    });
  });

  popupBlocks.forEach(function(item) {
    item.addEventListener("click", function(e) {
      e.stopPropagation();
    });
  });
}

body.addEventListener("click", function(e) {
  e.stopPropagation();
  popupBlocks.forEach(function(item) {
    if (item.classList.contains("active")) {
      item.classList.remove("active");
    }
  });
});

var accordion = document.querySelectorAll(".accordion");

for (var i = 0; i < accordion.length; i++) {
  accordion[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var panel = this.nextElementSibling;
    if (panel.style.maxHeight) {
      panel.style.maxHeight = null;
    } else {
      panel.style.maxHeight = panel.scrollHeight + "px";
    }
  });
}

var actionsBtn = document.querySelectorAll(".block__action-btn");

actionsBtn.forEach(function(btn) {
  btn.addEventListener("click", function() {
    actionsBtn.forEach(function(elem) {
      if (elem.classList.contains("block__action-btn_active")) {
        elem.classList.remove("block__action-btn_active");
      }
    });
    btn.classList.add("block__action-btn_active");
  });
});

var dataBtns = document.querySelectorAll(".data");
var dataIndicators = document.querySelectorAll(".data__indicator");
var forms = document.querySelectorAll('._form');
var cardForm = document.querySelector('._card');
var addressForm = document.querySelector('._address');

dataBtns.forEach(function(btn) {
  btn.addEventListener("click", function(e) {
    dataBtns.forEach(function(elem) {
      var elemName = elem.querySelector('.data__name');
      if (elemName.classList.contains("data__name_active")) {
        elemName.classList.remove("data__name_active");
      }
    });
    forms.forEach(function(elem) {
      if (elem.classList.contains("active")) {
        elem.classList.remove("active");
      }
    });
    dataIndicators.forEach(function(elem) {
      if (elem.classList.contains("data__indicator_active")) {
        elem.classList.remove("data__indicator_active");
      }
    });
    var parent = e.target.closest(".data");
    var indicator = parent.querySelector(".data__indicator");
    var elemName = btn.querySelector('.data__name');
    elemName.classList.add("data__name_active");
    indicator.classList.add("data__indicator_active");
    if (elemName.classList.contains("_card-btn")) {
      cardForm.classList.add('active');
    }
    if (elemName.classList.contains("_address-btn")) {
      addressForm.classList.add('active');
    }
  });
});


$(document).ready(function() {
  if ($(".select").length) {
    $(".select").select2({
      minimumResultsForSearch: Infinity
    });
  }
});

// var openMenu = document.querySelector('._open-menu');
// var closeMenu = document.querySelector('._close-menu');
// var menu = document.querySelector('._menu');
//
// openMenu.addEventListener('click', function(e) {
//   e.stopPropagation();
//   menu.classList.add('active');
// });
//
// closeMenu.addEventListener('click', function(e) {
//   e.stopPropagation();
//   menu.classList.remove('active');
// });

/*!
 * Pixel Perfect jQuery Plugin 
 * Author: @stefanoortisi
 * 
 * Licensed under the MIT license
 */

(function(e){"use strict";function t(e){return new RegExp("(^|\\s+)"+e+"(\\s+|$)")}function s(e,t){var s=n(e,t)?i:r;s(e,t)}var n,r,i;if("classList"in document.documentElement){n=function(e,t){return e.classList.contains(t)};r=function(e,t){e.classList.add(t)};i=function(e,t){e.classList.remove(t)}}else{n=function(e,n){return t(n).test(e.className)};r=function(e,t){if(!n(e,t)){e.className=e.className+" "+t}};i=function(e,n){e.className=e.className.replace(t(n)," ")}}var o={hasClass:n,addClass:r,removeClass:i,toggleClass:s,has:n,add:r,remove:i,toggle:s};if(typeof define==="function"&&define.amd){define(o)}else{e.classie=o}})(window)
__bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };


var pixelperfect = function() {

    var defaults = {
        prefix: "pixelperfect",
        dat_gui: true,
        visible: false,
        align: "center",
        opacity: 0.8
    };

    var image, toggle_button, original_overflow;

    function merge_options(obj1,obj2){

        var obj3 = {};
        for (var attrname in obj1) { obj3[attrname] = obj1[attrname]; }
        for (var attrname in obj2) { obj3[attrname] = obj2[attrname]; }
        return obj3;
    }

    function create_gui( ) {
        var DatConf = function() {
          this.opacity = defaults.opacity;
          this.show = false;
        };
    
        var conf = new DatConf();
        var gui = new dat.GUI();
        gui.add(conf, 'opacity', 0, 1).onChange( pixelperfect.set_opacity );
        gui.add(conf, 'preview').onChange( pixelperfect.toggle );
        var element_dat = document.querySelectorAll( ".dg.ac" )[0];
        classie.addClass( element_dat, defaults.prefix + "-dat" );

    }

    function add_ui( callback ) {
        
        if( typeof dat == "undefined" ){
            add_button();
        }
        
        
        add_image( defaults.image, callback );

        original_overflow = document.body.style.overflow;

    }

    function add_image( src, callback ) {
        var img = new Image()
        img.onload = function() {
            image = document.createElement( "img" );
            image.setAttribute( "class", defaults.prefix + "-image" );
            image.src = src;
            document.body.appendChild( image );

            if( defaults.align === "center" ){
                classie.addClass( image, "align-center" );
                image.style.marginLeft = - ( image.width / 2 ) + "px"
            }

            callback();
        }

        img.src = src;
    }

    function add_button() {
        toggle_button = document.createElement( "a" );
        toggle_button.setAttribute('class', defaults.prefix + '-btn');
        toggle_button.setAttribute('href', 'javascript:pixelperfect.toggle();');

        var icon = document.createElement( "span" );
        icon.innerHTML = "on/off";
        icon.setAttribute('class', defaults.prefix + '-btn-span');
        toggle_button.appendChild( icon );

        document.body.appendChild( toggle_button );
    }

    function show( el ){
        el.style.display = "none";
    }

    function hide( el ){
        el.style.display = "block";
    }

    return {

        init: function(options) {

            this.toggle         = __bind(this.toggle, this);
            this.set_opacity    = __bind(this.set_opacity, this);


            defaults = merge_options( defaults, options );

            defaults.dat_gui = typeof dat != "undefined"

            if( defaults.dat_gui ){
                create_gui();
            }

            add_ui( function() { 
                pixelperfect.set_opacity( defaults.opacity );
            });
            
        },

        toggle: function( ) {
    
            classie.toggle( image, "activated");
            if( !defaults.dat_gui ){
                classie.toggle( toggle_button, "activated");    
            }
            

            if( defaults.visible ) {
                document.body.style.overflow = "hidden";
            } else {
                document.body.style.overflow = original_overflow;
            }

        },

        set_opacity: function( value ) {
            image.style.opacity = value
        }

        
    };

}();

function openTab(evt, name) {
  var i, tabcontent, tablinks;

  tabcontent = document.getElementsByClassName("tabs__content");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }

  tablinks = document.getElementsByClassName("tabs__tab");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }

  document.getElementById(name).style.display = "block";
  evt.currentTarget.className += " active";
}

var defaultClick = document.querySelector("._default");

if (defaultClick) {
  defaultClick.click();
}
